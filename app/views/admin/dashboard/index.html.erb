<%= render 'shared/profile_modal' %>
<h1 class="mb-4 text-center">Admin Management</h1>
<p class="text-muted text-center">Welcome Admin, <strong><%= current_user.email %></strong>!</p>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h3>Users List</h3>
</div>
<table class="table table-hover table-bordered text-center">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>Email</th>
      <th>Status</th>
      <th>Role</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @users.each_with_index do |user, index| %>
      <tr id="user_<%= user.id %>">
        <td><strong><%= index + 1 %></strong></td>
        <td><%= user.email %></td>
        <td>
          <span class="badge rounded-pill <%= user.active ? 'bg-success' : 'bg-danger' %>">
            <%= user.active ? 'Active' : 'Inactive' %>
          </span>
        </td>
        <td>
          <span class="badge rounded-pill <%= user.manager? ? 'bg-info' : 'bg-secondary' %>">
            <%= user.manager? ? 'Manager' : 'User' %>
          </span>
        </td>
        <td>
          <div class="btn-group" role="group">
            <%= button_to (user.active ? 'Disable' : 'Enable'), 
                toggle_status_admin_user_path(user),
                method: :patch, 
                class: "btn btn-sm #{user.active ? 'btn-danger' : 'btn-success'} px-3 me-2",
                remote: true,
                data: { turbo_frame: "user_#{user.id}" } %>

            <%= button_to (user.manager? ? 'Remove Manager' : 'Make Manager'), 
                toggle_manager_admin_user_path(user),
                method: :patch, 
                class: 'btn btn-sm btn-warning px-3 me-2', 
                remote: true,
                data: { turbo_frame: "user_#{user.id}" } %>

            <%= link_to 'Edit', edit_admin_user_path(user), 
                class: 'btn btn-sm btn-info px-3 me-2' %>

            <%= link_to 'Delete', admin_user_path(user), data: 
            { turbo_method: :delete, turbo_confirm: 'Are you sure?' },
                class: 'btn btn-sm btn-danger px-3' %>
          </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
